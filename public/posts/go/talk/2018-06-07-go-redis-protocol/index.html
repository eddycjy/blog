<!DOCTYPE html>
<html lang="zh-hans">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta name="theme-color" content="#494f5c">
	<meta name="msapplication-TileColor" content="#494f5c">
<meta itemprop="name" content="ç”¨ Go æ¥äº†è§£ä¸€ä¸‹ Redis é€šè®¯åè®®">
<meta itemprop="description" content="Goã€PHPã€Java&hellip; éƒ½æœ‰é‚£ä¹ˆå¤šåŒ…æ¥æ”¯æ’‘ä½ ä½¿ç”¨ Redisï¼Œé‚£ä½ æ˜¯å¦æœ‰æƒ³è¿‡
æœ‰äº†æœåŠ¡ç«¯ï¼Œæœ‰äº†å®¢æˆ·ç«¯ï¼Œä»–ä»¬ä¿©æ˜¯æ€æ ·é€šè®¯ï¼Œåˆæ˜¯åŸºäºä»€ä¹ˆé€šè®¯åè®®åšå‡ºäº¤äº’çš„å‘¢ï¼Ÿ
ä»‹ç» åŸºäºæˆ‘ä»¬çš„ç›®çš„ï¼Œæœ¬æ–‡ä¸»è¦è®²è§£å’Œå®è·µ Redis çš„é€šè®¯åè®®
Redis çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ˜¯é€šè¿‡ TCP è¿æ¥æ¥è¿›è¡Œæ•°æ®äº¤äº’ï¼Œ æœåŠ¡å™¨é»˜è®¤çš„ç«¯å£å·ä¸º 6379
å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å‘é€çš„å‘½ä»¤æˆ–æ•°æ®ä¸€å¾‹ä»¥ \r\n ï¼ˆCRLFï¼‰ç»“å°¾ï¼ˆè¿™æ˜¯ä¸€æ¡çº¦å®šï¼‰
åè®® åœ¨ Redis ä¸­åˆ†ä¸ºè¯·æ±‚å’Œå›å¤ï¼Œè€Œè¯·æ±‚åè®®åˆåˆ†ä¸ºæ–°ç‰ˆå’Œæ—§ç‰ˆï¼Œæ–°ç‰ˆç»Ÿä¸€è¯·æ±‚åè®®åœ¨ Redis 1.2 ç‰ˆæœ¬ä¸­å¼•å…¥ï¼Œæœ€ç»ˆåœ¨ Redis 2.0 ç‰ˆæœ¬æˆä¸º Redis æœåŠ¡å™¨é€šä¿¡çš„æ ‡å‡†æ–¹å¼
æœ¬æ–‡æ˜¯åŸºäºæ–°ç‰ˆåè®®æ¥å®ç°åŠŸèƒ½ï¼Œä¸å»ºè®®ä½¿ç”¨æ—§ç‰ˆï¼ˆ1.2 æŒºè€æ—§äº†ï¼‰ã€‚å¦‚ä¸‹æ˜¯æ–°åè®®çš„å„ç§èŒƒä¾‹ï¼š
è¯·æ±‚åè®® 1ã€ æ ¼å¼ç¤ºä¾‹
*&lt;å‚æ•°æ•°é‡&gt; CR LF $&lt;å‚æ•° 1 çš„å­—èŠ‚æ•°é‡&gt; CR LF &lt;å‚æ•° 1 çš„æ•°æ®&gt; CR LF ... $&lt;å‚æ•° N çš„å­—èŠ‚æ•°é‡&gt; CR LF &lt;å‚æ•° N çš„æ•°æ®&gt; CR LF åœ¨è¯¥åè®®ä¸‹æ‰€æœ‰å‘é€è‡³ Redis æœåŠ¡å™¨çš„å‚æ•°éƒ½æ˜¯äºŒè¿›åˆ¶å®‰å…¨ï¼ˆbinary safeï¼‰çš„
2ã€æ‰“å°ç¤ºä¾‹
*3 $3 SET $5 mykey $7 myvalue 3ã€å®é™…åè®®å€¼">
<meta itemprop="datePublished" content="2018-06-07T12:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2018-06-07T12:00:00&#43;00:00" />
<meta itemprop="wordCount" content="463">



<meta itemprop="keywords" content="go," /><meta property="og:title" content="ç”¨ Go æ¥äº†è§£ä¸€ä¸‹ Redis é€šè®¯åè®®" />
<meta property="og:description" content="Goã€PHPã€Java&hellip; éƒ½æœ‰é‚£ä¹ˆå¤šåŒ…æ¥æ”¯æ’‘ä½ ä½¿ç”¨ Redisï¼Œé‚£ä½ æ˜¯å¦æœ‰æƒ³è¿‡
æœ‰äº†æœåŠ¡ç«¯ï¼Œæœ‰äº†å®¢æˆ·ç«¯ï¼Œä»–ä»¬ä¿©æ˜¯æ€æ ·é€šè®¯ï¼Œåˆæ˜¯åŸºäºä»€ä¹ˆé€šè®¯åè®®åšå‡ºäº¤äº’çš„å‘¢ï¼Ÿ
ä»‹ç» åŸºäºæˆ‘ä»¬çš„ç›®çš„ï¼Œæœ¬æ–‡ä¸»è¦è®²è§£å’Œå®è·µ Redis çš„é€šè®¯åè®®
Redis çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ˜¯é€šè¿‡ TCP è¿æ¥æ¥è¿›è¡Œæ•°æ®äº¤äº’ï¼Œ æœåŠ¡å™¨é»˜è®¤çš„ç«¯å£å·ä¸º 6379
å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å‘é€çš„å‘½ä»¤æˆ–æ•°æ®ä¸€å¾‹ä»¥ \r\n ï¼ˆCRLFï¼‰ç»“å°¾ï¼ˆè¿™æ˜¯ä¸€æ¡çº¦å®šï¼‰
åè®® åœ¨ Redis ä¸­åˆ†ä¸ºè¯·æ±‚å’Œå›å¤ï¼Œè€Œè¯·æ±‚åè®®åˆåˆ†ä¸ºæ–°ç‰ˆå’Œæ—§ç‰ˆï¼Œæ–°ç‰ˆç»Ÿä¸€è¯·æ±‚åè®®åœ¨ Redis 1.2 ç‰ˆæœ¬ä¸­å¼•å…¥ï¼Œæœ€ç»ˆåœ¨ Redis 2.0 ç‰ˆæœ¬æˆä¸º Redis æœåŠ¡å™¨é€šä¿¡çš„æ ‡å‡†æ–¹å¼
æœ¬æ–‡æ˜¯åŸºäºæ–°ç‰ˆåè®®æ¥å®ç°åŠŸèƒ½ï¼Œä¸å»ºè®®ä½¿ç”¨æ—§ç‰ˆï¼ˆ1.2 æŒºè€æ—§äº†ï¼‰ã€‚å¦‚ä¸‹æ˜¯æ–°åè®®çš„å„ç§èŒƒä¾‹ï¼š
è¯·æ±‚åè®® 1ã€ æ ¼å¼ç¤ºä¾‹
*&lt;å‚æ•°æ•°é‡&gt; CR LF $&lt;å‚æ•° 1 çš„å­—èŠ‚æ•°é‡&gt; CR LF &lt;å‚æ•° 1 çš„æ•°æ®&gt; CR LF ... $&lt;å‚æ•° N çš„å­—èŠ‚æ•°é‡&gt; CR LF &lt;å‚æ•° N çš„æ•°æ®&gt; CR LF åœ¨è¯¥åè®®ä¸‹æ‰€æœ‰å‘é€è‡³ Redis æœåŠ¡å™¨çš„å‚æ•°éƒ½æ˜¯äºŒè¿›åˆ¶å®‰å…¨ï¼ˆbinary safeï¼‰çš„
2ã€æ‰“å°ç¤ºä¾‹
*3 $3 SET $5 mykey $7 myvalue 3ã€å®é™…åè®®å€¼" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://eddycjy.com/posts/go/talk/2018-06-07-go-redis-protocol/" />
<meta property="article:published_time" content="2018-06-07T12:00:00+00:00" />
<meta property="article:modified_time" content="2018-06-07T12:00:00+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ç”¨ Go æ¥äº†è§£ä¸€ä¸‹ Redis é€šè®¯åè®®"/>
<meta name="twitter:description" content="Goã€PHPã€Java&hellip; éƒ½æœ‰é‚£ä¹ˆå¤šåŒ…æ¥æ”¯æ’‘ä½ ä½¿ç”¨ Redisï¼Œé‚£ä½ æ˜¯å¦æœ‰æƒ³è¿‡
æœ‰äº†æœåŠ¡ç«¯ï¼Œæœ‰äº†å®¢æˆ·ç«¯ï¼Œä»–ä»¬ä¿©æ˜¯æ€æ ·é€šè®¯ï¼Œåˆæ˜¯åŸºäºä»€ä¹ˆé€šè®¯åè®®åšå‡ºäº¤äº’çš„å‘¢ï¼Ÿ
ä»‹ç» åŸºäºæˆ‘ä»¬çš„ç›®çš„ï¼Œæœ¬æ–‡ä¸»è¦è®²è§£å’Œå®è·µ Redis çš„é€šè®¯åè®®
Redis çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ˜¯é€šè¿‡ TCP è¿æ¥æ¥è¿›è¡Œæ•°æ®äº¤äº’ï¼Œ æœåŠ¡å™¨é»˜è®¤çš„ç«¯å£å·ä¸º 6379
å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å‘é€çš„å‘½ä»¤æˆ–æ•°æ®ä¸€å¾‹ä»¥ \r\n ï¼ˆCRLFï¼‰ç»“å°¾ï¼ˆè¿™æ˜¯ä¸€æ¡çº¦å®šï¼‰
åè®® åœ¨ Redis ä¸­åˆ†ä¸ºè¯·æ±‚å’Œå›å¤ï¼Œè€Œè¯·æ±‚åè®®åˆåˆ†ä¸ºæ–°ç‰ˆå’Œæ—§ç‰ˆï¼Œæ–°ç‰ˆç»Ÿä¸€è¯·æ±‚åè®®åœ¨ Redis 1.2 ç‰ˆæœ¬ä¸­å¼•å…¥ï¼Œæœ€ç»ˆåœ¨ Redis 2.0 ç‰ˆæœ¬æˆä¸º Redis æœåŠ¡å™¨é€šä¿¡çš„æ ‡å‡†æ–¹å¼
æœ¬æ–‡æ˜¯åŸºäºæ–°ç‰ˆåè®®æ¥å®ç°åŠŸèƒ½ï¼Œä¸å»ºè®®ä½¿ç”¨æ—§ç‰ˆï¼ˆ1.2 æŒºè€æ—§äº†ï¼‰ã€‚å¦‚ä¸‹æ˜¯æ–°åè®®çš„å„ç§èŒƒä¾‹ï¼š
è¯·æ±‚åè®® 1ã€ æ ¼å¼ç¤ºä¾‹
*&lt;å‚æ•°æ•°é‡&gt; CR LF $&lt;å‚æ•° 1 çš„å­—èŠ‚æ•°é‡&gt; CR LF &lt;å‚æ•° 1 çš„æ•°æ®&gt; CR LF ... $&lt;å‚æ•° N çš„å­—èŠ‚æ•°é‡&gt; CR LF &lt;å‚æ•° N çš„æ•°æ®&gt; CR LF åœ¨è¯¥åè®®ä¸‹æ‰€æœ‰å‘é€è‡³ Redis æœåŠ¡å™¨çš„å‚æ•°éƒ½æ˜¯äºŒè¿›åˆ¶å®‰å…¨ï¼ˆbinary safeï¼‰çš„
2ã€æ‰“å°ç¤ºä¾‹
*3 $3 SET $5 mykey $7 myvalue 3ã€å®é™…åè®®å€¼"/>

	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="/favicon.ico">

	<title>ç”¨ Go æ¥äº†è§£ä¸€ä¸‹ Redis é€šè®¯åè®®</title>
	<link rel="stylesheet" href="https://eddycjy.com/css/style.min.43ade9343bda1e3f53fcb45dc776c310b369f2a93c03dee67c82401987989309.css">
	
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp faster">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="https://eddycjy.com">ç…é±¼</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					<a href="https://eddycjy.com/posts/">Posts</a>
					<a href="https://eddycjy.com/tags/">Tags</a>
					<a href="https://eddycjy.com/about/">About</a>
				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<button id="toc-btn" class="hdr-btn desktop-only-ib" title="Table of Contents"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3" y2="6"></line><line x1="3" y1="12" x2="3" y2="12"></line><line x1="3" y1="18" x2="3" y2="18"></line></svg></button><span class="hdr-social hide-in-mobile"><a href="https://github.com/eddycjy" target="_blank" rel="noopener me" title="Github"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a></span><button id="menu-btn" class="hdr-btn" title="Menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="https://eddycjy.com/posts/">Posts</a></li>
			<li><a href="https://eddycjy.com/tags/">Tags</a></li>
			<li><a href="https://eddycjy.com/about/">About</a></li>
		</ul>
	</div>


	<main class="site-main section-inner animated fadeIn faster">
		<article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>Jun 7, 2018</span></div>
				<h1>ç”¨ Go æ¥äº†è§£ä¸€ä¸‹ Redis é€šè®¯åè®®</h1>
			</header>
			<div class="content">
				<p>Goã€PHPã€Java&hellip; éƒ½æœ‰é‚£ä¹ˆå¤šåŒ…æ¥æ”¯æ’‘ä½ ä½¿ç”¨ Redisï¼Œé‚£ä½ æ˜¯å¦æœ‰æƒ³è¿‡</p>
<p>æœ‰äº†æœåŠ¡ç«¯ï¼Œæœ‰äº†å®¢æˆ·ç«¯ï¼Œä»–ä»¬ä¿©æ˜¯æ€æ ·é€šè®¯ï¼Œåˆæ˜¯åŸºäºä»€ä¹ˆé€šè®¯åè®®åšå‡ºäº¤äº’çš„å‘¢ï¼Ÿ</p>
<h2 id="ä»‹ç»">ä»‹ç»<a href="#ä»‹ç»" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>åŸºäºæˆ‘ä»¬çš„ç›®çš„ï¼Œæœ¬æ–‡ä¸»è¦è®²è§£å’Œå®è·µ Redis çš„é€šè®¯åè®®</p>
<p>Redis çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯æ˜¯é€šè¿‡ TCP è¿æ¥æ¥è¿›è¡Œæ•°æ®äº¤äº’ï¼Œ æœåŠ¡å™¨é»˜è®¤çš„ç«¯å£å·ä¸º 6379</p>
<p>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å‘é€çš„å‘½ä»¤æˆ–æ•°æ®ä¸€å¾‹ä»¥ \r\n ï¼ˆCRLFï¼‰ç»“å°¾ï¼ˆè¿™æ˜¯ä¸€æ¡çº¦å®šï¼‰</p>
<h2 id="åè®®">åè®®<a href="#åè®®" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>åœ¨ Redis ä¸­åˆ†ä¸º<strong>è¯·æ±‚</strong>å’Œ<strong>å›å¤</strong>ï¼Œè€Œè¯·æ±‚åè®®åˆåˆ†ä¸ºæ–°ç‰ˆå’Œæ—§ç‰ˆï¼Œæ–°ç‰ˆç»Ÿä¸€è¯·æ±‚åè®®åœ¨ Redis 1.2 ç‰ˆæœ¬ä¸­å¼•å…¥ï¼Œæœ€ç»ˆåœ¨ Redis 2.0 ç‰ˆæœ¬æˆä¸º Redis æœåŠ¡å™¨é€šä¿¡çš„æ ‡å‡†æ–¹å¼</p>
<p>æœ¬æ–‡æ˜¯åŸºäºæ–°ç‰ˆåè®®æ¥å®ç°åŠŸèƒ½ï¼Œä¸å»ºè®®ä½¿ç”¨æ—§ç‰ˆï¼ˆ1.2 æŒºè€æ—§äº†ï¼‰ã€‚å¦‚ä¸‹æ˜¯æ–°åè®®çš„å„ç§èŒƒä¾‹ï¼š</p>
<h3 id="è¯·æ±‚åè®®">è¯·æ±‚åè®®<a href="#è¯·æ±‚åè®®" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>1ã€ æ ¼å¼ç¤ºä¾‹</p>
<pre><code>*&lt;å‚æ•°æ•°é‡&gt; CR LF
$&lt;å‚æ•° 1 çš„å­—èŠ‚æ•°é‡&gt; CR LF
&lt;å‚æ•° 1 çš„æ•°æ®&gt; CR LF
...
$&lt;å‚æ•° N çš„å­—èŠ‚æ•°é‡&gt; CR LF
&lt;å‚æ•° N çš„æ•°æ®&gt; CR LF
</code></pre><p>åœ¨è¯¥åè®®ä¸‹æ‰€æœ‰å‘é€è‡³ Redis æœåŠ¡å™¨çš„å‚æ•°éƒ½æ˜¯äºŒè¿›åˆ¶å®‰å…¨ï¼ˆbinary safeï¼‰çš„</p>
<p>2ã€æ‰“å°ç¤ºä¾‹</p>
<pre><code>*3
$3
SET
$5
mykey
$7
myvalue
</code></pre><p>3ã€å®é™…åè®®å€¼</p>
<pre><code>&quot;*3\r\n$3\r\nSET\r\n$5\r\nmykey\r\n$7\r\nmyvalue\r\n&quot;
</code></pre><p>è¿™å°±æ˜¯ Redis çš„è¯·æ±‚åè®®è§„èŒƒï¼ŒæŒ‰ç…§èŒƒä¾‹1ç¼–å†™å®¢æˆ·ç«¯é€»è¾‘ï¼Œæœ€ç»ˆå‘é€çš„æ˜¯èŒƒä¾‹3ï¼Œç›¸ä¿¡ä½ å·²ç»æœ‰å¤§è‡´çš„æ¦‚å¿µäº†ï¼ŒRedis çš„åè®®éå¸¸çš„ç®€æ´æ˜“æ‡‚ï¼Œè¿™ä¹Ÿæ˜¯å¥½ä¸Šæ‰‹çš„åŸå› ä¹‹ä¸€ï¼Œä½ å¯ä»¥æƒ³æƒ³åè®®è¿™ä¹ˆå®šä¹‰çš„å¥½å¤„åœ¨å“ªï¼Ÿ</p>
<h3 id="å›å¤">å›å¤<a href="#å›å¤" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>Redis ä¼šæ ¹æ®ä½ è¯·æ±‚åè®®çš„ä¸åŒï¼ˆæ‰§è¡Œçš„å‘½ä»¤ç»“æœä¹Ÿä¸åŒï¼‰ï¼Œè¿”å›å¤šç§ä¸åŒç±»å‹çš„å›å¤ã€‚åœ¨è¿™ä¸ªå›å¤â€œåè®®â€ä¸­ï¼Œå¯ä»¥é€šè¿‡æ£€æŸ¥ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œç¡®å®šè¿™ä¸ªå›å¤æ˜¯ä»€ä¹ˆç±»å‹ï¼Œå¦‚ä¸‹ï¼š</p>
<ul>
<li>çŠ¶æ€å›å¤ï¼ˆstatus replyï¼‰çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ &ldquo;+&rdquo;</li>
<li>é”™è¯¯å›å¤ï¼ˆerror replyï¼‰çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ &ldquo;-&rdquo;</li>
<li>æ•´æ•°å›å¤ï¼ˆinteger replyï¼‰çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ &ldquo;:&rdquo;</li>
<li>æ‰¹é‡å›å¤ï¼ˆbulk replyï¼‰çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ &ldquo;$&rdquo;</li>
<li>å¤šæ¡æ‰¹é‡å›å¤ï¼ˆmulti bulk replyï¼‰çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ &ldquo;*&rdquo;</li>
</ul>
<p>æœ‰äº†å›å¤çš„å¤´éƒ¨æ ‡è¯†ï¼Œç»“å°¾çš„ CRLFï¼Œä½ å¯ä»¥å¤§è‡´çŒœæƒ³å‡ºå›å¤â€œåè®®â€æ˜¯æ€ä¹ˆæ ·çš„ï¼Œä½†æ˜¯å®è·µæ‰èƒ½å¾—å‡ºçœŸç†ï¼Œæ–çŸ¥é“æ€•æ˜¯ä½ å¾ˆå¿«å°±å¿˜è®°äº† ğŸ˜€</p>
<h2 id="å®è·µ">å®è·µ<a href="#å®è·µ" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<h3 id="ä¸-redis-æœåŠ¡å™¨äº¤äº’">ä¸ Redis æœåŠ¡å™¨äº¤äº’<a href="#ä¸-redis-æœåŠ¡å™¨äº¤äº’" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<pre><code>package main

import (
	&quot;log&quot;
	&quot;net&quot;
	&quot;os&quot;

	&quot;github.com/EDDYCJY/redis-protocol-example/protocol&quot;
)

const (
	Address = &quot;127.0.0.1:6379&quot;
	Network = &quot;tcp&quot;
)

func Conn(network, address string) (net.Conn, error) {
	conn, err := net.Dial(network, address)
	if err != nil {
		return nil, err
	}

	return conn, nil
}

func main() {
        // è¯»å–å…¥å‚
	args := os.Args[1:]
	if len(args) &lt;= 0 {
		log.Fatalf(&quot;Os.Args &lt;= 0&quot;)
	}
    
        // è·å–è¯·æ±‚åè®®
	reqCommand := protocol.GetRequest(args)
	
	// è¿æ¥ Redis æœåŠ¡å™¨
	redisConn, err := Conn(Network, Address)
	if err != nil {
		log.Fatalf(&quot;Conn err: %v&quot;, err)
	}
	defer redisConn.Close()
    
        // å†™å…¥è¯·æ±‚å†…å®¹
	_, err = redisConn.Write(reqCommand)
	if err != nil {
		log.Fatalf(&quot;Conn Write err: %v&quot;, err)
	}
    
        // è¯»å–å›å¤
	command := make([]byte, 1024)
	n, err := redisConn.Read(command)
	if err != nil {
		log.Fatalf(&quot;Conn Read err: %v&quot;, err)
	}
    
        // å¤„ç†å›å¤
	reply, err := protocol.GetReply(command[:n])
	if err != nil {
		log.Fatalf(&quot;protocol.GetReply err: %v&quot;, err)
	}
    
        // å¤„ç†åçš„å›å¤å†…å®¹
	log.Printf(&quot;Reply: %v&quot;, reply)
	// åŸå§‹çš„å›å¤å†…å®¹
	log.Printf(&quot;Command: %v&quot;, string(command[:n]))
}
</code></pre><p>åœ¨è¿™é‡Œæˆ‘ä»¬å®Œæˆäº†æ•´ä¸ª Redis å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯äº¤äº’çš„æµç¨‹ï¼Œåˆ†åˆ«å¦‚ä¸‹ï¼š</p>
<p>1ã€è¯»å–å‘½ä»¤è¡Œå‚æ•°ï¼šè·å–æ‰§è¡Œçš„ Redis å‘½ä»¤</p>
<p>2ã€è·å–è¯·æ±‚åè®®å‚æ•°</p>
<p>3ã€è¿æ¥ Redis æœåŠ¡å™¨ï¼Œè·å–è¿æ¥å¥æŸ„</p>
<p>4ã€å°†è¯·æ±‚åè®®å‚æ•°å†™å…¥è¿æ¥ï¼šå‘é€è¯·æ±‚çš„å‘½ä»¤è¡Œå‚æ•°</p>
<p>5ã€ä»è¿æ¥ä¸­è¯»å–è¿”å›çš„æ•°æ®ï¼šè¯»å–å…ˆå‰è¯·æ±‚çš„å›å¤æ•°æ®</p>
<p>6ã€æ ¹æ®å›å¤â€œåè®®â€å†…å®¹ï¼Œå¤„ç†å›å¤çš„æ•°æ®é›†</p>
<p>7ã€è¾“å‡ºå¤„ç†åçš„å›å¤å†…å®¹åŠåŸå§‹å›å¤å†…å®¹</p>
<h3 id="è¯·æ±‚">è¯·æ±‚<a href="#è¯·æ±‚" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<pre><code>func GetRequest(args []string) []byte {
	req := []string{
		&quot;*&quot; + strconv.Itoa(len(args)),
	}

	for _, arg := range args {
		req = append(req, &quot;$&quot;+strconv.Itoa(len(arg)))
		req = append(req, arg)
	}

	str := strings.Join(req, &quot;\r\n&quot;)
	return []byte(str + &quot;\r\n&quot;)
}
</code></pre><p>é€šè¿‡å¯¹ Redis çš„è¯·æ±‚åè®®çš„åˆ†æï¼Œå¯å¾—å‡ºå®ƒçš„è§„å¾‹ï¼Œå…ˆåŠ ä¸Šæ ‡å¿—ä½ï¼Œè®¡ç®—å‚æ•°æ€»æ•°é‡ï¼Œå†å¾ªç¯åˆå¹¶å„ä¸ªå‚æ•°çš„å­—èŠ‚æ•°é‡ã€å€¼å°±å¯ä»¥äº†</p>
<h3 id="å›å¤-1">å›å¤<a href="#å›å¤-1" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<pre><code>func GetReply(reply []byte) (interface{}, error) {
	replyType := reply[0]
	switch replyType {
	case StatusReply:
		return doStatusReply(reply[1:])
	case ErrorReply:
		return doErrorReply(reply[1:])
	case IntegerReply:
		return doIntegerReply(reply[1:])
	case BulkReply:
		return doBulkReply(reply[1:])
	case MultiBulkReply:
		return doMultiBulkReply(reply[1:])
	default:
		return nil, nil
	}
}

func doStatusReply(reply []byte) (string, error) {
	if len(reply) == 3 &amp;&amp; reply[1] == 'O' &amp;&amp; reply[2] == 'K' {
		return OkReply, nil
	}

	if len(reply) == 5 &amp;&amp; reply[1] == 'P' &amp;&amp; reply[2] == 'O' &amp;&amp; reply[3] == 'N' &amp;&amp; reply[4] == 'G' {
		return PongReply, nil
	}

	return string(reply), nil
}

func doErrorReply(reply []byte) (string, error) {
	return string(reply), nil
}

func doIntegerReply(reply []byte) (int, error) {
	pos := getFlagPos('\r', reply)
	result, err := strconv.Atoi(string(reply[:pos]))
	if err != nil {
		return 0, err
	}

	return result, nil
}

...
</code></pre><p>åœ¨è¿™é‡Œæˆ‘ä»¬å¯¹æ‰€æœ‰å›å¤ç±»å‹è¿›è¡Œäº†åˆ†å‘ï¼Œä¸åŒçš„å›å¤æ ‡å¿—ä½å¯¹åº”ä¸åŒçš„å¤„ç†æ–¹å¼ï¼Œåœ¨è¿™é‡Œéœ€æ±‚æ³¨æ„å‡ é¡¹é—®é¢˜ï¼Œå¦‚ä¸‹ï¼š</p>
<p>1ã€å½“è¯·æ±‚çš„å€¼ä¸å­˜åœ¨ï¼Œä¼šå°†ç‰¹æ®Šå€¼ -1 ç”¨ä½œå›å¤</p>
<p>2ã€æœåŠ¡å™¨å‘é€çš„æ‰€æœ‰å­—ç¬¦ä¸²éƒ½ç”± CRLF ç»“å°¾</p>
<p>3ã€å¤šæ¡æ‰¹é‡å›å¤æ˜¯å¯åŸºäºæ‰¹é‡å›å¤çš„ï¼Œè¦æ³¨æ„ç†è§£</p>
<p>4ã€æ— å†…å®¹çš„å¤šæ¡æ‰¹é‡å›å¤æ˜¯å­˜åœ¨çš„</p>
<p>æœ€é‡è¦çš„æ˜¯ï¼Œå¯¹ä¸åŒå›å¤çš„è§„åˆ™çš„æŠŠæ§ï¼Œèƒ½å¤Ÿè®©ä½ æ›´å¥½çš„ç†è§£ Redis çš„è¯·æ±‚ã€å›å¤çš„äº¤äº’è¿‡ç¨‹ ğŸ‘Œ</p>
<h2 id="å°ç»“">å°ç»“<a href="#å°ç»“" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>å†™è¿™ç¯‡æ–‡ç« çš„èµ·å› ï¼Œæ˜¯å› ä¸ºå¸¸å¸¸åœ¨ä½¿ç”¨ Redis æ—¶ï¼Œåªæ˜¯ç”¨ï¼Œä½ ä¸çŸ¥é“å®ƒæ˜¯åŸºäºä»€ä¹ˆæ ·çš„é€šè®¯åè®®æ¥é€šè®¯ï¼Œè¿™æ ·çš„æ„Ÿè§‰æ˜¯ååˆ†éš¾å—çš„</p>
<p>é€šè¿‡æœ¬æ–‡çš„è®²è§£ï¼Œæˆ‘ç›¸ä¿¡ä½ å·²ç»å¤§è‡´äº†è§£ Redis å®¢æˆ·ç«¯æ˜¯æ€ä¹ˆæ ·å’ŒæœåŠ¡ç«¯äº¤äº’ï¼Œä¹Ÿæ¸…æ¥šäº†å…¶æ‰€ç”¨çš„é€šè®¯åŸç†ï¼Œå¸Œæœ›èƒ½å¤Ÿå¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼</p>
<p>æœ€åï¼Œå¦‚æœæƒ³è¯¦ç»†æŸ¥çœ‹ä»£ç ï¼Œå³æ‹é¡¹ç›®åœ°å€ï¼šhttps://github.com/EDDYCJY/redis-protocol-example</p>
<p>å¦‚æœå¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹ä¸ª Star ğŸ‘</p>
<h2 id="å‚è€ƒ">å‚è€ƒ<a href="#å‚è€ƒ" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<ul>
<li><a href="http://doc.redisfans.com/topic/protocol.html">é€šä¿¡åè®®</a></li>
</ul>

			</div>
			<hr class="post-end">
			<footer class="post-info">
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://eddycjy.com/tags/go">go</a></span>
				</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>463 Words</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2018-06-07 20:00 &#43;0800</p>
			</footer>
		</article>
		<aside id="toc" class="show-toc">
			<div class="toc-title">Table of Contents</div>
			<nav id="TableOfContents">
  <ul>
    <li><a href="#ä»‹ç»">ä»‹ç»</a></li>
    <li><a href="#åè®®">åè®®</a>
      <ul>
        <li><a href="#è¯·æ±‚åè®®">è¯·æ±‚åè®®</a></li>
        <li><a href="#å›å¤">å›å¤</a></li>
      </ul>
    </li>
    <li><a href="#å®è·µ">å®è·µ</a>
      <ul>
        <li><a href="#ä¸-redis-æœåŠ¡å™¨äº¤äº’">ä¸ Redis æœåŠ¡å™¨äº¤äº’</a></li>
        <li><a href="#è¯·æ±‚">è¯·æ±‚</a></li>
        <li><a href="#å›å¤-1">å›å¤</a></li>
      </ul>
    </li>
    <li><a href="#å°ç»“">å°ç»“</a></li>
    <li><a href="#å‚è€ƒ">å‚è€ƒ</a></li>
  </ul>
</nav>
		</aside>
		<div class="post-nav thin">
			<a class="next-post" href="https://eddycjy.com/posts/go/gin/2018-06-14-excel/">
				<span class="post-nav-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>&nbsp;Newer</span><br><span>ã€Œè¿è½½åå››ã€å®ç°å¯¼å‡ºã€å¯¼å…¥ Excel</span>
			</a>
			<a class="prev-post" href="https://eddycjy.com/posts/go/gin/2018-06-02-application-redis/">
				<span class="post-nav-label">Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span><br><span>ã€Œè¿è½½åä¸‰ã€ä¼˜åŒ–ä½ çš„åº”ç”¨ç»“æ„å’Œå®ç°Redisç¼“å­˜</span>
			</a>
		</div>
		<div id="comments" class="thin">
						<script src="https://utteranc.es/client.js"
							repo="eddycjy/blog"
							issue-term="pathname"
							theme="github-light"
							crossorigin="anonymous"
							async>
			</script>
		</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2020 <a href="https://eddycjy.com">ç…é±¼</a> &#183; <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></p>
		<p>
			Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> &#183; Theme <a href="https://github.com/Track3/hermit" target="_blank" rel="noopener">Hermit</a> &#183; <a href="https://eddycjy.com/post/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
		</p>
	</footer>


	<script src="https://eddycjy.com/js/main.min.784417f5847151f848c339cf0acb13a06cbb648b1483435a28ed4556c4ead69b.js"></script>

</body>

</html>
